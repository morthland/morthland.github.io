function getHiddenProp(){var e=["webkit","moz","ms","o"];if("hidden"in document)return"hidden";for(var t=0;t<e.length;t++){if(e[t]+"Hidden"in document)return e[t]+"Hidden"}return null}function isHidden(){var e=getHiddenProp();if(!e)return false;return document[e]}String.prototype.queryStringToJSON=String.prototype.queryStringToJSON||function(){var params=String(this);params=params.substring(params.indexOf("?")+1);params=params.replace(/\+/g,"%20");if(params.substring(0,1)==="{"&&params.substring(params.length-1)==="}"){return eval(decodeURIComponent(params))}params=params.split(/\&(amp\;)?/);var json={};for(var i=0,n=params.length;i<n;++i){var param=params[i]||null;if(param===null){continue}param=param.split("=");if(param===null){continue}var key=param[0]||null;if(key===null){continue}if(typeof param[1]==="undefined"){continue}var value=param[1];key=decodeURIComponent(key);value=decodeURIComponent(value);try{value=eval(value)}catch(e){}var keys=key.split(".");if(keys.length===1){json[key]=value}else{var path="",cmd="";$.each(keys,function(ii,key){path+='["'+key.replace(/"/g,'\\"')+'"]';jsonCLOSUREGLOBAL=json;cmd="if ( typeof jsonCLOSUREGLOBAL"+path+' === "undefined" ) jsonCLOSUREGLOBAL'+path+" = {}";eval(cmd);json=jsonCLOSUREGLOBAL;delete jsonCLOSUREGLOBAL});jsonCLOSUREGLOBAL=json;valueCLOSUREGLOBAL=value;cmd="jsonCLOSUREGLOBAL"+path+" = valueCLOSUREGLOBAL";eval(cmd);json=jsonCLOSUREGLOBAL;delete jsonCLOSUREGLOBAL;delete valueCLOSUREGLOBAL}}return json};$.extend($.expr[":"],{inViewport:function(e){var t=document.documentElement.scrollTop||document.body.scrollTop,n=$(e).offset().top,r=$(e).height();winH=window.innerHeight&&window.innerHeight<$(window).height()?window.innerHeight:$(window).height();return n+r>t&&n<t+winH}});var Gamma=function(){var e=$(window),t=$("body"),n=$(document),r=window.Modernizr,i={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},s=i[r.prefixed("transition")],o={columns:4,speed:300,easing:"ease",overlayAnimated:true,nextOnClickImage:true,circular:true,svImageTransitionSpeedFade:300,svImageTransitionEasingFade:"ease-in-out",svImageTransitionSpeedResize:300,svImageTransitionEasingResize:"ease-in-out",svMarginsVH:{vertical:140,horizontal:120},keyboard:true,swipe:true,interval:4e3,historyapi:true},u=function(e,t){Gamma.settings=$.extend(true,{},o,e);a();p();m(function(){Gamma.container.removeClass("gamma-loading");Gamma.items.show();if(Gamma.settings.historyapi){c()}_initEvents("window");if(t){t.call()}})},a=function(){Gamma.container=$("#gamma-container");Gamma.overlay=Gamma.container.find("div.gamma-overlay");Gamma.controls=Gamma.container.children("div.gamma-options");Gamma.gallery=Gamma.container.children("ul.gamma-gallery");Gamma.items=Gamma.gallery.children();Gamma.itemsCount=Gamma.items.length;Gamma.columns=Gamma.settings.columns;Gamma.isAnimating=true;Gamma.svMargins=Gamma.settings.svMarginsVH;var e=window.History;if(!e.enabled&&Gamma.settings.historyapi){Gamma.settings.historyapi=false}Gamma.supportTransitions=r.csstransitions},f=function(){if(!Gamma.singleview){$('<div class="gamma-single-view"><div class="gamma-options gamma-options-single"><div class="gamma-buttons"><button class="gamma-btn-close"></button></div></div></div>').appendTo(Gamma.container);Gamma.singleview=Gamma.container.children("div.gamma-single-view");Gamma.svclose=Gamma.singleview.find("button.gamma-btn-close");_initEvents("singleview");l()}else if(!Gamma.nav){l()}},l=function(){if(Gamma.itemsCount>1){Gamma.svplay=$('<button class="gamma-btn-ssplay"></button>').insertAfter(Gamma.svclose);Gamma.nav=$('<nav class="gamma-nav"><span class="gamma-prev"></span><span class="gamma-next"></span></nav>').appendTo(Gamma.singleview);Gamma.svnavnext=Gamma.nav.find("span.gamma-next");Gamma.svnavprev=Gamma.nav.find("span.gamma-prev");_initEvents("singleviewnavigation")}},c=function(e,t){if(Gamma.settings.historyapi){t=t||History.getState().url.queryStringToJSON().id}var n=t!=undefined,e=e||false;if(Gamma.settings.historyapi&&Gamma.isSV&&t===undefined){_closesingleview()}if(n){var r=Gamma.items.eq(Math.abs(t));if(r.length){if(Gamma.svImage){if(Gamma.supportTransitions){_setTransition(Gamma.svImage,"all",Gamma.settings.svImageTransitionSpeedFade,Gamma.settings.svImageTransitionEasingFade)}_applyAnimation(Gamma.svImage,{opacity:0},Gamma.settings.svImageTransitionSpeedFade,Gamma.supportTransitions,function(){$(this).remove();e=false;_singleviewitem(r,e)});if(Gamma.svDescription){_applyAnimation(Gamma.svDescription,{opacity:0},400,Gamma.supportTransitions)}}else{if(Gamma.svDescription){Gamma.svDescription.empty()}_singleviewitem(r,e)}}}},h=function(e){if(!Gamma.settings.historyapi&&e!=undefined){Gamma.isSV?c(false,e):c(true,e)}else if(e===undefined){History.pushState(null,null,url("protocol")+"://"+url("hostname")+url("path"))}else if(History.getState().url.queryStringToJSON().id!==e){History.pushState(null,null,"?id="+e)}},p=function(e){if(Gamma.itemsCount>0){f()}v();var e=e||Gamma.items.hide();e.each(function(){var e=$(this),t=e.children(),n=d(t),r=y(n,e.outerWidth(true)),i=t.data("description");e.data({description:i,source:n,maxwidth:t.data("maxWidth"),maxheight:t.data("maxHeight")});$("<div/>").addClass("gamma-description").html(i).insertAfter(t);$("<img/>").attr({alt:t.data("alt"),title:t.data("title"),src:r.src}).insertAfter(t);t.remove()})},d=function(e){var t=[];e.children("div").each(function(e){var n=$(this);t.push({width:n.data("minWidth")||0,src:n.data("src"),pos:e})});return t},v=function(){var e=Gamma.container.width();if(Gamma.settings.viewport){for(var t=0,n=Gamma.settings.viewport.length;t<n;++t){var r=Gamma.settings.viewport[t];if(e>r.width){Gamma.columns=r.columns;break}}}Gamma.items.css("width",Math.floor(e/Gamma.columns)*100/e+"%")},m=function(e){Gamma.gallery.imagesLoaded(function(){Gamma.gallery.masonry({itemSelector:"li",columnWidth:function(e){return e/Gamma.columns}});if(e){e.call()}})},g=function(e){clearTimeout(Gamma.masonrytimeout);e=e||0;Gamma.masonrytimeout=setTimeout(function(){Gamma.gallery.masonry("reload")},e)},y=function(e,t){if(t<=0){t=1}for(var n=0,r=e.length;n<r;++n){var i=e[n];if(t>i.width){return i}}},b=function(e,t,n){n?e.css(n):t==="on"?e.show():e.hide()},w=function(e){if(!Gamma.slideshow){E(e)}},E=function(e){if(!Gamma.isSV||Gamma.isAnimating){return false}var t=Gamma.current;if(e==="next"){Gamma.current=Gamma.current<Gamma.itemsCount-1?++Gamma.current:Gamma.settings.circular?0:Gamma.current}else if(e==="prev"){Gamma.current=Gamma.current>0?--Gamma.current:Gamma.settings.circular?Gamma.itemsCount-1:Gamma.current}if(t===Gamma.current){return false}Gamma.isAnimating=true;h(Gamma.current)},S=function(){v();x();if(Gamma.isSV){_svResizeImage()}g(200)},x=function(){Gamma.items.each(function(){var e=$(this),t=y(e.data("source"),Gamma.items.outerWidth(true));e.find("img").attr("src",t.src)})};_svResizeImage=function(t){var n=_getFinalImgConfig({sources:Gamma.svImage.data("source"),imgMaxW:Gamma.svImage.data("maxwidth"),imgMaxH:Gamma.svImage.data("maxheight"),wrapper:{width:e.width()-Gamma.svMargins.horizontal,height:e.height()-Gamma.svMargins.vertical},image:{width:Gamma.svImage.width(),height:Gamma.svImage.height()}}),r=n.source,i=n.finalSizePosition,o=Gamma.svImage.attr("src"),u={width:i.width,height:i.height,left:i.left+Gamma.svMargins.horizontal/2,top:i.top+Gamma.svMargins.vertical/2};_applyAnimation(Gamma.svImage,u,Gamma.settings.svImageTransitionSpeedResize,Gamma.supportTransitions,function(){if(Gamma.supportTransitions){$(this).off(s)}if(o!==r.src){Gamma.isAnimating=true;var e=Gamma.svImage.width(),n=Gamma.svImage.height(),i=Gamma.svImage.position().left,u=Gamma.svImage.position().top;Gamma.svImage=$("<img/>").load(function(){var e=$(this);if(Gamma.supportTransitions){_setTransition(e,"all",Gamma.settings.svImageTransitionSpeedResize,Gamma.settings.svImageTransitionEasingResize)}_applyAnimation(e.next(),{opacity:0},500,Gamma.supportTransitions,function(){var e=$(this);if(Gamma.supportTransitions){$(this).off(s)}e.remove();Gamma.isAnimating=false})}).css({width:e,height:n,left:i,top:u}).data(Gamma.svImage.data()).insertBefore(Gamma.svImage).attr("src",r.src)}if(t){t.call()}})},_getFinalImgConfig=function(e){var t=e.sources,n=e.imgMaxW||0,r=e.imgMaxH||0,i=y(t,e.wrapper.width),s=_getFinalSizePosition(e.image,e.wrapper);if(s.checksource){i=y(t,s.width)}if(i.pos===0&&(n!==0&&s.width>n||r!==0&&s.height>r)){if(n!==0&&s.width>n){var o=s.width/n;s.width=n;s.height/=o}else if(r!==0&&s.height>r){var o=s.height/r;s.height=r;s.width/=o}s.left=e.wrapper.width/2-s.width/2;s.top=e.wrapper.height/2-s.height/2}return{source:i,finalSizePosition:s}},_singleview=function(){var e=$(this).index();h(e)},_singleviewitem=function(n,r){Gamma.isSV=true;var i=n.index(),o=n.data(),u=n.children("img");if(r){Gamma.fly=$("<img/>").attr("src",u.attr("src")).addClass("gamma-img-fly").css({width:u.width(),height:u.height(),left:n.offset().left+(n.outerWidth(true)-n.width())/2,top:n.offset().top+(n.outerHeight(true)-n.height())/2}).appendTo(t);if(Gamma.supportTransitions){_setTransition(Gamma.fly)}}var a=_getFinalImgConfig({sources:n.data("source"),imgMaxW:n.data("maxwidth"),imgMaxH:n.data("maxheight"),wrapper:{width:e.width()-Gamma.svMargins.horizontal,height:e.height()-Gamma.svMargins.vertical},image:{width:u.width(),height:u.height()}}),f=a.source,l=a.finalSizePosition;Gamma.current=i;Gamma.overlay.show();if(Gamma.settings.overlayAnimated&&r&&Gamma.supportTransitions){_setTransition(Gamma.overlay,"opacity")}setTimeout(function(){_applyAnimation(Gamma.overlay,{opacity:1},Gamma.settings.speed,Gamma.supportTransitions||!r,function(){if(!Gamma.isSV){return false}if(Gamma.supportTransitions){$(this).off(s)}t.css("overflow-y","hidden");var e=Gamma.overlay[0];e.style.display="none";e.offsetHeight;e.style.display="block"});n.css("visibility","hidden");if(!r){_loadSVItemFromGrid(o,l,f.src)}else{var i={width:l.width,height:l.height,left:l.left+e.scrollLeft()+Gamma.svMargins.horizontal/2,top:l.top+e.scrollTop()+Gamma.svMargins.vertical/2},u=Gamma.supportTransitions;_applyAnimation(Gamma.fly,i,Gamma.settings.speed,u,function(){if(u){$(this).off(s)}_loadSVItemFromGrid(o,l,f.src)})}},25)},_loadSVItemFromGrid=function(e,t,n){Gamma.singleview.show();if(!Gamma.svDescription){Gamma.svDescription=$("<div/>").addClass("gamma-description").appendTo(Gamma.singleview).wrap('<div class="gamma-description-wrapper"></div>');if(Gamma.supportTransitions){_setTransition(Gamma.svDescription,"opacity",Gamma.settings.svImageTransitionSpeedFade/2,Gamma.settings.svImageTransitionEasingFade)}}Gamma.svDescription.html(e.description);var r=setTimeout(function(){Gamma.singleview.addClass("gamma-loading")},Gamma.settings.svImageTransitionSpeedFade+250);Gamma.svImage=$("<img/>").load(function(){var e=$(this);clearTimeout(r);Gamma.singleview.removeClass("gamma-loading");setTimeout(function(){_applyAnimation(Gamma.svDescription,{opacity:1},Gamma.settings.svImageTransitionSpeedFade/2,Gamma.supportTransitions)},25);e.css({width:t.width,height:t.height,left:t.left+Gamma.svMargins.horizontal/2,top:t.top+Gamma.svMargins.vertical/2}).appendTo(Gamma.singleview);if(Gamma.supportTransitions){_setTransition(e,"all",Gamma.settings.svImageTransitionSpeedResize,Gamma.settings.svImageTransitionEasingResize)}if(Gamma.fly){if(Gamma.supportTransitions){_setTransition(Gamma.fly,"opacity",1e3)}setTimeout(function(){_applyAnimation(Gamma.fly,{opacity:0},1e3,Gamma.supportTransitions,function(){var e=$(this);if(Gamma.supportTransitions){e.off(s)}e.remove();Gamma.fly=null;Gamma.isAnimating=false})},25)}else{Gamma.isAnimating=false}}).data(e).attr("src",n)},_getFinalSizePosition=function(e,t){var n=e.width,r=e.height,i=t.width,s=t.height,o,u,a,f,l=false;if(n>r){o=i;var c=n/i;u=r/c;if(u>s){l=true;c=u/s;o/=c;u=s}}else{u=s;var c=r/s;o=n/c;l=true;if(o>i){l=false;c=o/i;o=i;u/=c}}return{width:o,height:u,left:i/2-o/2,top:s/2-u/2,checksource:l}},_closesingleview=function(){if(Gamma.isAnimating||Gamma.fly){return false}Gamma.isSV=false;if(Gamma.slideshow){_stopSlideshow()}var r=Gamma.items.eq(Gamma.current),i=r.children("img");Gamma.items.not(r).css("visibility","visible");var o=e.scrollTop();if(!r.is(":inViewport")){o=r.offset().top+(r.outerHeight(true)-r.height())/2;var u=n.height()-e.height();if(o>u){o=u}e.scrollTop(o)}var a=Gamma.svImage.position().left+e.scrollLeft(),f=Gamma.svImage.position().top+o;Gamma.svImage.appendTo(t).css({position:"absolute",zIndex:1e4,left:a,top:f});if(Gamma.supportTransitions){_setTransition(Gamma.svImage)}Gamma.singleview.hide();Gamma.svDescription.empty().css("opacity",0);t.css("overflow-y","scroll");setTimeout(function(){var e={width:i.width(),height:i.height(),left:r.offset().left+(r.outerWidth(true)-r.width())/2,top:r.offset().top+(r.outerHeight(true)-r.height())/2};_applyAnimation(Gamma.svImage,e,Gamma.settings.speed,Gamma.supportTransitions,function(){r.css("visibility","visible");$(this).remove();Gamma.svImage=null});if(Gamma.settings.overlayAnimated){if(Gamma.supportTransitions){_setTransition(Gamma.overlay,"opacity")}_applyAnimation(Gamma.overlay,{opacity:0},Gamma.settings.speed,Gamma.supportTransitions,function(){var e=$(this);if(Gamma.supportTransitions){e.off(s)}e.hide()})}else{Gamma.overlay.hide()}h()},25)},_visChange=function(){if(Gamma.slideshow){isHidden()?(_stopSlideshow(true),Gamma.slideshow=true):_prepareSlideshow()}},_prepareSlideshow=function(){if(Gamma.isAnimating&&!Gamma.slideshow){return false}Gamma.isAnimating=true;clearTimeout(Gamma.slideshowtimeout);Gamma.slideshow=true;Gamma.svMargins={vertical:0,horizontal:0};b(Gamma.svclose,"off");b(Gamma.svnavprev,"off",{left:-40});b(Gamma.svnavnext,"off",{right:-40});_svResizeImage(function(){Gamma.isAnimating=false;Gamma.svplay.addClass("gamma-btn-sspause");_startSlideshow()})},_preloadNext=function(){var t=Gamma.current<Gamma.itemsCount-1?Gamma.current+1:Gamma.settings.circular?0:Gamma.current,n=Gamma.items.eq(t),r=n.children("img"),i=_getFinalImgConfig({sources:n.data("source"),imgMaxW:n.data("maxwidth"),imgMaxH:n.data("maxheight"),wrapper:{width:e.width()-Gamma.svMargins.horizontal,height:e.height()-Gamma.svMargins.vertical},image:{width:r.width(),height:r.height()}}),s=i.source;$("<img/>").attr("src",s.src)},_startSlideshow=function(){_preloadNext();Gamma.slideshowtimeout=setTimeout(function(){E("next");_startSlideshow()},Gamma.settings.interval)},_stopSlideshow=function(e){if(Gamma.isAnimating){return false}Gamma.isAnimating=true;clearTimeout(Gamma.slideshowtimeout);if(!e){Gamma.slideshow=false;Gamma.svplay.removeClass("gamma-btn-sspause");Gamma.svMargins=Gamma.settings.svMarginsVH;b(Gamma.svclose,"on");b(Gamma.svnavprev,"on",{left:20});b(Gamma.svnavnext,"on",{right:20});_svResizeImage(function(){Gamma.isAnimating=false})}},_initEvents=function(t){switch(t){case"window":if(Gamma.settings.historyapi){e.on("statechange.gamma",function(){c(true)})}e.on("smartresize.gamma",S);var r=getHiddenProp();if(r){var i=r.replace(/[H|h]idden/,"")+"visibilitychange";document.addEventListener(i,_visChange)}break;case"singleview":Gamma.gallery.on("click.gamma","li",_singleview);Gamma.svclose.on("click.gamma",_closesingleview);break;case"singleviewnavigation":Gamma.svnavnext.on("click.gamma",function(){w("next")});Gamma.svnavprev.on("click.gamma",function(){w("prev")});if(Gamma.settings.nextOnClickImage){Gamma.singleview.on("click.gamma","img",function(){w("next")})}if(Gamma.settings.keyboard){n.on("keydown.gamma",function(e){var t=e.keyCode||e.which,n={left:37,up:38,right:39,down:40};switch(t){case n.left:w("prev");break;case n.right:w("next");break}})}if(Gamma.settings.swipe){Gamma.singleview.on({"swipeleft.gamma":function(){w("next")},"swiperight.gamma":function(){w("prev")}})}Gamma.svplay.on("click.gamma",function(){if(Gamma.slideshow){_stopSlideshow()}else if(!Gamma.isAnimating){_prepareSlideshow()}});break}},_setTransition=function(e,t,n,r){if(!t){t="all"}if(!n){n=Gamma.settings.speed}if(!r){r=Gamma.settings.easing}e.css("transition",t+" "+n+"ms "+r)},_applyAnimation=function(e,t,n,r,i){$.fn.applyStyle=r?$.fn.css:$.fn.animate;if(i&&r){e.on(s,i)}i=i||function(){return false};e.stop().applyStyle(t,$.extend(true,[],{duration:n+"ms",complete:i}))},add=function(e){Gamma.gallery.append(e);Gamma.items=Gamma.gallery.children();Gamma.itemsCount=Gamma.items.length;p(e);g()};return{init:u,add:add}}()